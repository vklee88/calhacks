(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{33:function(t,e,a){t.exports=a(72)},38:function(t,e,a){},67:function(t,e){},70:function(t,e,a){},72:function(t,e,a){"use strict";a.r(e);var n=a(0),o=a.n(n),r=a(26),s=a.n(r),i=(a(38),a(27)),c=a(28),l=a(31),u=a(29),h=a(32),d=a(4),m=a(30),v=a.n(m),f=(a(70),function(t){function e(t){var a;Object(i.a)(this,e),(a=Object(l.a)(this,Object(u.a)(e).call(this,t))).BROWSER_ERR="You seem to using a browser that does not support video. Please don't use IE or upgrade your browser.",a.PERMISSION_ERR="You need to allow access to a camera to run this app.",a.RATE=33,a.URL="http://localhost:5000",a.videoRef=o.a.createRef();var n=document.createElement("canvas"),r=n.getContext("2d");return n.width=300,n.height=300,a.state={err:null,socket:null,storedStream:null,snapshotter:null,run:!1,imageData:null,fileReader:new FileReader,canvas:n,ctx:r},a.uploadData=a.uploadData.bind(Object(d.a)(Object(d.a)(a))),a}return Object(h.a)(e,t),Object(c.a)(e,[{key:"startRecording",value:function(){var t=this;if(!this.state.storedStream){var e=this.videoRef.current;if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){var a=v()(this.URL);this.setState({socket:a}),a.on("connect",function(){navigator.mediaDevices.getUserMedia({video:!0}).then(function(a){e.src=window.URL.createObjectURL(a),t.setState({err:null,storedStream:a,run:!0}),t.takeSnapshot(null,e)}).catch(function(e){var a=e.message;"PermissionDeniedError"===e.name&&(a=t.PERMISSION_ERR),t.setState({err:a})})}),a.on("connect_timeout",function(){alert("Timeout when connecting to server"),t.state.socket.close(),t.setState({socket:null})}),a.on("prediction",function(e){t.setState({imageData:e})})}else this.setState({err:this.BROWSER_ERR})}}},{key:"stopRecording",value:function(){if(this.state.socket&&(this.state.socket.close(),this.setState({socket:null})),this.state.storedStream){var t=!0,e=!1,a=void 0;try{for(var n,o=this.state.storedStream.getTracks()[Symbol.iterator]();!(t=(n=o.next()).done);t=!0){n.value.stop()}}catch(r){e=!0,a=r}finally{try{t||null==o.return||o.return()}finally{if(e)throw a}}this.setState({storedStream:null})}this.state.snapshotter&&(clearTimeout(this.state.snapshotter),this.setState({snapshotter:null,run:!1}))}},{key:"takeSnapshot",value:function(t,e){var a=this;if(this.state.run)var n=setTimeout(function(t){t=t||0,a.setState({snapshotter:n}),a.takeASnap(e).then(function(t){return a.uploadData(t)}).then(function(){t++,a.takeSnapshot(t,e)})},20,t)}},{key:"takeASnap",value:function(t){var e=this,a=this.state.canvas;return this.state.ctx.drawImage(t,0,0,a.width,a.height),new Promise(function(t){a.toBlob(function(a){var n=e.state.fileReader;n.readAsDataURL(a),n.onloadend=function(){var e=n.result;t(e)}},"image/jpeg")})}},{key:"uploadData",value:function(t){var e=this;if(this.state.socket)return new Promise(function(a){e.state.socket.emit("data",t,function(t){a(t)})})}},{key:"render",value:function(){var t=this;return o.a.createElement("div",{className:"App"},o.a.createElement("div",null,o.a.createElement("button",{className:"button",onClick:function(){return t.startRecording()}},"Start Video"),o.a.createElement("button",{className:"button",onClick:function(){return t.stopRecording()}},"End Video")),this.state.err&&o.a.createElement("p",null,this.state.err," Refresh the browser and try again."),o.a.createElement("br",null),o.a.createElement("div",{className:"centered"},o.a.createElement("video",{className:"vid",height:"300",width:"300",ref:this.videoRef,autoPlay:!0}),o.a.createElement("img",{className:"vid",height:"300",width:"300",src:this.state.imageData,alt:"no data yet"})))}}]),e}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(o.a.createElement(f,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}},[[33,2,1]]]);
//# sourceMappingURL=main.29072765.chunk.js.map