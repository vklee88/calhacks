(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{33:function(t,e,n){t.exports=n(72)},38:function(t,e,n){},67:function(t,e){},70:function(t,e,n){},72:function(t,e,n){"use strict";n.r(e);var a=n(1),o=n.n(a),r=n(26),i=n.n(r),s=(n(38),n(27)),c=n(28),l=n(31),u=n(29),d=n(32),h=n(4),v=n(30),f=n.n(v),m=(n(70),function(t){function e(t){var n;return Object(s.a)(this,e),(n=Object(l.a)(this,Object(u.a)(e).call(this,t))).BROWSER_ERR="You seem to using a browser that does not support video. Please don't use IE or upgrade your browser.",n.PERMISSION_ERR="You need to allow access to a camera to run this app.",n.RATE=1e3,n.URL="http://localhost:5000",n.videoRef=o.a.createRef(),n.state={err:null,socket:null,storedStream:null,snapshotter:null},n.uploadData=n.uploadData.bind(Object(h.a)(Object(h.a)(n))),n}return Object(d.a)(e,t),Object(c.a)(e,[{key:"startRecording",value:function(){var t=this;if(!this.state.storedStream){var e=this.videoRef.current;if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){var n=f()(this.URL);this.setState({socket:n}),n.on("connect",function(){navigator.mediaDevices.getUserMedia({video:!0}).then(function(n){e.src=window.URL.createObjectURL(n);var a=!0,o=setInterval(function(){a&&(a=!1,t.takeASnap(e).then(function(e){return t.uploadData(e)}).then(function(t){console.log(t),a=!0}).catch(function(t){console.log("Failed response from server"),a=!0}))},t.RATE);t.setState({err:null,storedStream:n,snapshotter:o})}).catch(function(e){var n=e.message;"PermissionDeniedError"===e.name&&(n=t.PERMISSION_ERR),t.setState({err:n})})}),n.on("connect_timeout",function(){alert("Timeout when connecting to server"),t.state.socket.close(),t.setState({socket:null})})}else this.setState({err:this.BROWSER_ERR})}}},{key:"stopRecording",value:function(){if(this.state.socket&&(this.state.socket.close(),this.setState({socket:null})),this.state.storedStream){var t=!0,e=!1,n=void 0;try{for(var a,o=this.state.storedStream.getTracks()[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){a.value.stop()}}catch(r){e=!0,n=r}finally{try{t||null==o.return||o.return()}finally{if(e)throw n}}this.setState({storedStream:null})}this.state.snapshotter&&(clearInterval(this.state.snapshotter),this.setState({snapshotter:null}))}},{key:"takeASnap",value:function(t){var e=document.createElement("canvas"),n=e.getContext("2d");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0,e.width,e.height),new Promise(function(t,n){e.toBlob(function(e){var n=new FileReader;n.readAsDataURL(e),n.onloadend=function(){var e=n.result;t(e)}},"image/jpeg")})}},{key:"uploadData",value:function(t){var e=this;if(this.state.socket)return new Promise(function(n,a){e.state.socket.emit("data",t,function(t){t?n(t):a("Not acknowledged")})})}},{key:"render",value:function(){var t=this;return o.a.createElement("div",null,o.a.createElement("div",null,o.a.createElement("button",{onClick:function(){return t.startRecording()}},"Start Video"),o.a.createElement("button",{onClick:function(){return t.stopRecording()}},"End Video")),this.state.err&&o.a.createElement("p",null,this.state.err," Refresh the browser and try again."),o.a.createElement("video",{height:"300",width:"300",ref:this.videoRef,autoPlay:!0}))}}]),e}(a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(m,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}},[[33,2,1]]]);
//# sourceMappingURL=main.a093fd2b.chunk.js.map